<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}نظام إدارة العملاء والموردين{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e2e8f0;
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .navbar-brand {
            font-weight: bold;
            color: #e2e8f0 !important;
        }
        
        .card {
            background: rgba(30, 30, 46, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            color: #e2e8f0;
        }
        
        .card-header {
            background: rgba(45, 55, 72, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            border: none;
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6578 0%, #3d4758 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            border: none;
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            border: none;
            color: #1a202c;
            transition: all 0.3s ease;
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #ed8936 0%, #d69e2e 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
            border: none;
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .btn-info:hover {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            border: none;
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .sidebar {
            min-height: 100vh;
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar .nav-link {
            color: #a0aec0;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 2px 8px;
        }
        
        .sidebar .nav-link:hover {
            color: #e2e8f0;
            background: rgba(74, 85, 104, 0.3);
            transform: translateX(5px);
        }
        
        .sidebar .nav-link.active {
            color: #e2e8f0;
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
        }
        
        .main-content {
            margin-right: 250px;
            padding: 20px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                margin-right: 0;
            }
        }
        
        .stats-card {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-card-success {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-card-warning {
            background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            color: #1a202c;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-card-info {
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .table {
            color: #e2e8f0 !important;
            background: transparent;
        }
        
        .table td, .table th {
            color: #e2e8f0 !important;
            border-color: rgba(255, 255, 255, 0.1) !important;
        }
        
        .table-dark {
            background: rgba(45, 55, 72, 0.8) !important;
            color: #e2e8f0 !important;
        }
        
        .table-dark th, .table-dark td {
            color: #f7fafc !important;
            border-color: rgba(255, 255, 255, 0.2) !important;
        }
        
        .table-striped > tbody > tr:nth-of-type(odd) > td {
            background: rgba(45, 55, 72, 0.3) !important;
            color: #e2e8f0 !important;
        }
        
        .table-hover > tbody > tr:hover > td {
            background: rgba(74, 85, 104, 0.3) !important;
            color: #f7fafc !important;
        }
        
        /* Ensure all table text is visible */
        .table tbody tr td {
            color: #e2e8f0 !important;
        }
        
        .table tbody tr td strong {
            color: #f7fafc !important;
        }
        
        /* Fix for any remaining black text in tables */
        .table * {
            color: inherit !important;
        }
        
        /* Specific fixes for table content */
        .table .badge {
            color: #1a202c !important;
        }
        
        .table .badge.bg-success {
            color: #1a202c !important;
        }
        
        .table .badge.bg-primary {
            color: #f7fafc !important;
        }
        
        .table .badge.bg-warning {
            color: #1a202c !important;
        }
        
        .table .badge.bg-info {
            color: #1a202c !important;
        }
        
        .table .badge.bg-danger {
            color: #f7fafc !important;
        }
        
        .form-control {
            background: rgba(45, 55, 72, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }
        
        .form-control:focus {
            background: rgba(45, 55, 72, 0.9);
            border-color: #4a5568;
            box-shadow: 0 0 0 0.2rem rgba(74, 85, 104, 0.25);
            color: #f7fafc;
        }
        
        .form-control::placeholder {
            color: #a0aec0;
        }
        
        .form-select {
            background: rgba(45, 55, 72, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }
        
        .form-select:focus {
            background: rgba(45, 55, 72, 0.9);
            border-color: #4a5568;
            box-shadow: 0 0 0 0.2rem rgba(74, 85, 104, 0.25);
            color: #f7fafc;
        }
        
        .form-label {
            color: #cbd5e0;
            font-weight: 500;
        }
        
        .alert-success {
            background: rgba(56, 161, 105, 0.2);
            border: 1px solid rgba(56, 161, 105, 0.3);
            color: #68d391;
        }
        
        .alert-danger {
            background: rgba(229, 62, 62, 0.2);
            border: 1px solid rgba(229, 62, 62, 0.3);
            color: #f56565;
        }
        
        .alert-warning {
            background: rgba(214, 158, 46, 0.2);
            border: 1px solid rgba(214, 158, 46, 0.3);
            color: #f6e05e;
        }
        
        .alert-info {
            background: rgba(49, 130, 206, 0.2);
            border: 1px solid rgba(49, 130, 206, 0.3);
            color: #63b3ed;
        }
        
        .navbar {
            background: rgba(26, 32, 44, 0.95) !important;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .navbar .nav-link {
            color: #a0aec0 !important;
        }
        
        .badge {
            font-weight: 500;
        }
        
        .text-muted {
            color: #a0aec0 !important;
        }
        
        /* Fix for white background cards and elements */
        .bg-white {
            background: rgba(30, 30, 46, 0.95) !important;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            color: #e2e8f0 !important;
        }
        
        .bg-light {
            background: rgba(45, 55, 72, 0.8) !important;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            color: #e2e8f0 !important;
        }
        
        .bg-primary {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%) !important;
            color: #e2e8f0 !important;
        }
        
        .text-primary {
            color: #63b3ed !important;
        }
        
        .text-success {
            color: #68d391 !important;
        }
        
        .text-danger {
            color: #f56565 !important;
        }
        
        .text-warning {
            color: #f6e05e !important;
        }
        
        .text-info {
            color: #63b3ed !important;
        }
        
        .text-white {
            color: #f7fafc !important;
        }
        
        /* Navbar brand and text colors */
        .navbar-brand, .navbar .navbar-brand {
            color: #e2e8f0 !important;
        }
        
        .navbar-light .navbar-brand {
            color: #e2e8f0 !important;
        }
        
        .navbar-light .navbar-nav .nav-link {
            color: #a0aec0 !important;
        }
        
        /* Card headers */
        .card-header.bg-primary {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%) !important;
            color: #e2e8f0 !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Small text and muted text */
        small, .small {
            color: #a0aec0 !important;
        }
        
        small.text-muted, .small.text-muted {
            color: #718096 !important;
        }
        
        small.text-success, .small.text-success {
            color: #68d391 !important;
        }
        
        /* Icons in cards */
        .fa-2x {
            opacity: 0.8;
        }
        
        /* Summary cards specific styling */
        .card .card-body h5 {
            color: #cbd5e0;
            font-weight: 500;
        }
        
        .card .card-body h3 {
            font-weight: 600;
        }
        
        .card .card-body h6 {
            color: #cbd5e0;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar position-fixed top-0 end-0 h-100 d-none d-md-block">
        <div class="p-3">
            <h5 class="text-white">نظام الإدارة</h5>
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('dashboard') }}">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    لوحة التحكم
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('customers') }}">
                    <i class="fas fa-users me-2"></i>
                    العملاء
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('suppliers') }}">
                    <i class="fas fa-truck me-2"></i>
                    الموردين
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="toggleSubmenu('sales')">
                    <i class="fas fa-shopping-cart me-2"></i>
                    المبيعات
                    <i class="fas fa-chevron-down float-start"></i>
                </a>
                <ul class="nav flex-column ms-3" id="sales-submenu" style="display: none;">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('sales_invoices') }}">فواتير المبيعات</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('collections') }}">التحصيلات</a>
                    </li>
                </ul>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="toggleSubmenu('purchases')">
                    <i class="fas fa-shopping-bag me-2"></i>
                    المشتريات
                    <i class="fas fa-chevron-down float-start"></i>
                </a>
                <ul class="nav flex-column ms-3" id="purchases-submenu" style="display: none;">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('purchase_invoices') }}">فواتير المشتريات</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('payments') }}">المدفوعات</a>
                    </li>
                </ul>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="toggleSubmenu('reports')">
                    <i class="fas fa-chart-bar me-2"></i>
                    التقارير
                    <i class="fas fa-chevron-down float-start"></i>
                </a>
                <ul class="nav flex-column ms-3" id="reports-submenu" style="display: none;">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('customer_reports') }}">تقارير العملاء</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('supplier_reports') }}">تقارير الموردين</a>
                    </li>
                </ul>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('backup') }}">
                    <i class="fas fa-database me-2"></i>
                    النسخ الاحتياطي
                </a>
            </li>
            <li class="nav-item mt-3">
                <a class="nav-link text-danger" href="{{ url_for('logout') }}">
                    <i class="fas fa-sign-out-alt me-2"></i>
                    تسجيل الخروج
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white mb-4 rounded shadow-sm">
            <div class="container-fluid">
                <button class="navbar-toggler d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <span class="navbar-brand mb-0 h1">{% block page_title %}نظام إدارة العملاء والموردين{% endblock %}</span>
                <div class="navbar-nav ms-auto">
                    <span class="nav-link">مرحباً، {{ current_user.username }}</span>
                </div>
            </div>
        </nav>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Page Content -->
        {% block content %}{% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function toggleSubmenu(menuId) {
            const submenu = document.getElementById(menuId + '-submenu');
            if (submenu.style.display === 'none' || submenu.style.display === '') {
                submenu.style.display = 'block';
            } else {
                submenu.style.display = 'none';
            }
        }

        // Auto-hide alerts after 5 seconds
        setTimeout(function() {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                const bsAlert = new bootstrap.Alert(alert);
                bsAlert.close();
            });
        }, 5000);
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
